<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Olimpiyat KokoreÃ§ MenÃ¼</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background-color: #fff7f0; }
    .active-tab { background-color: #fb923c; color: white; }
    /* MenÃ¼ sekmelerinin gÃ¶rÃ¼nÃ¼mÃ¼ iÃ§in kaydÄ±rma Ã§ubuÄŸunu gizle */
    #categoryTabs::-webkit-scrollbar { display: none; }
    #categoryTabs { -ms-overflow-style: none; /* IE and Edge */ scrollbar-width: none; /* Firefox */ }
  </style>
</head>
<body class="text-gray-800">
  <header class="bg-orange-500 text-white p-4 flex justify-between items-center sticky top-0 z-10 shadow-md">
    <h1 class="text-2xl font-bold">Olimpiyat KokoreÃ§</h1>
    <div class="flex items-center gap-2">
      <button id="langTR" class="bg-white text-orange-600 px-3 py-1 rounded font-bold">TR</button>
      <button id="langEN" class="bg-white text-orange-600 px-3 py-1 rounded">EN</button>
      <button id="adminLoginBtn" class="bg-white text-orange-600 px-3 py-1 rounded">âš™ï¸ YÃ¶netici GiriÅŸi</button>
    </div>
  </header>

  <nav id="categoryTabs" class="flex overflow-x-auto bg-white shadow p-2 space-x-2 text-sm font-semibold sticky top-[64px] z-10"></nav>

  <main class="p-4">
    <div id="menuContainer" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
        </div>

    <div id="contactSection" class="hidden text-center mt-6 bg-white rounded-xl shadow p-6 max-w-lg mx-auto">
      <h2 id="contactTitle" class="text-2xl font-bold text-orange-600 mb-3">Ä°letiÅŸim</h2>
      <p id="contactAddress" class="mb-3">ğŸ“ Yamanevler Mah. AlemdaÄŸ Caddesi No 159 D<br>Olimpiyat KokoreÃ§ Ãœmraniye - Ä°stanbul</p>
      <p class="mt-2">ğŸ“ <a href="tel:02163357920" id="contactPhone" class="text-orange-600 font-semibold text-lg hover:underline">0216 335 79 20</a></p>
    </div>
  </main>

  <div id="imageModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex justify-center items-center z-50 transition-opacity">
    <img id="modalImage" class="max-h-[90vh] max-w-[90vw] rounded-xl shadow-2xl transition-transform">
  </div>

  <div id="adminPanel" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50">
    <div class="bg-white rounded-xl shadow-lg p-6 w-96 relative">
      <button id="closeAdmin" class="absolute top-2 right-2 text-gray-500 hover:text-gray-800">âœ–</button>
      <h2 class="text-xl font-bold mb-3 text-orange-600">YÃ¶netici GiriÅŸi</h2>
      <input id="passwordInput" type="password" placeholder="Åifreyi giriniz" class="border w-full p-2 rounded mb-3 focus:ring-orange-500 focus:border-orange-500" />
      <button id="checkPassword" class="bg-orange-500 text-white px-4 py-2 rounded w-full hover:bg-orange-600 transition">GiriÅŸ Yap</button>
      <p id="loginError" class="text-red-600 text-sm mt-2 hidden">HatalÄ± ÅŸifre!</p>
    </div>
  </div>

  <div id="editPanel" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50">
    <div class="bg-white rounded-xl shadow-lg p-6 w-[600px] relative max-h-[90vh] overflow-y-auto">
      <button id="closeEdit" class="absolute top-2 right-2 text-gray-500 hover:text-gray-800">âœ–</button>
      <h2 class="text-xl font-bold mb-3 text-orange-600">ÃœrÃ¼n YÃ¶netimi</h2>
      
      <div class="flex flex-col gap-2 mb-4 p-4 border rounded-lg bg-orange-50">
        <h3 class="font-bold text-lg mb-1">Yeni ÃœrÃ¼n Ekle</h3>
        <input id="productName" placeholder="ÃœrÃ¼n AdÄ± (TR)" class="border p-2 rounded" />
        <input id="productDesc" placeholder="AÃ§Ä±klama (TR)" class="border p-2 rounded" />
        <input id="productDescEN" placeholder="AÃ§Ä±klama (EN)" class="border p-2 rounded" />
        <input id="productPrice" type="number" placeholder="Fiyat (â‚º)" class="border p-2 rounded" />
        <input id="productImageFile" type="file" accept="image/*" class="border p-2 rounded bg-white" />
        <select id="productCategory" class="border p-2 rounded">
          </select>
        <button id="addProduct" class="bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 transition">ÃœrÃ¼n Ekle</button>
      </div>

      <h3 class="font-semibold mb-2">Mevcut ÃœrÃ¼nler</h3>
      <div class="flex gap-2 mb-2">
        <select id="filterCategory" class="border p-2 rounded flex-1"></select>
      </div>
      <ul id="productList" class="flex flex-col gap-2"></ul>
    </div>
  </div>

  <div id="editProductModal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50">
    <div class="bg-white rounded-xl shadow-lg p-6 w-[500px] relative max-h-[90vh] overflow-y-auto">
      <button id="closeEditProductModal" class="absolute top-2 right-2 text-gray-500 hover:text-gray-800">âœ–</button>
      <h2 class="text-xl font-bold mb-3 text-orange-600">ÃœrÃ¼n DÃ¼zenle</h2>
      
      <input type="hidden" id="editProductIndex" />
      
      <div class="flex flex-col gap-3">
        
        <div class="p-3 border rounded-lg bg-gray-50">
            <h3 class="font-semibold mb-2">GÃ¶rsel DÃ¼zenleme</h3>
            <img id="editImagePreview" class="w-full h-32 object-cover rounded-lg mb-2 border border-gray-300" src="" alt="ÃœrÃ¼n GÃ¶rseli Ã–nizleme">
            
            <label class="block text-sm font-medium mb-1">Yeni GÃ¶rsel URL'si:</label>
            <input id="editImageURL" placeholder="Yeni GÃ¶rsel URL'si girin" class="border w-full p-2 rounded mb-2 text-sm" />

            <label class="block text-sm font-medium mb-1">Veya Yeni GÃ¶rsel YÃ¼kle:</label>
            <input id="editImageFile" type="file" accept="image/*" class="border w-full p-1 rounded bg-white text-sm" />
            <p class="text-xs text-gray-500 mt-1">Dosya seÃ§ilirse URL alanÄ± yok sayÄ±lÄ±r.</p>
        </div>

        <input id="editName" placeholder="ÃœrÃ¼n AdÄ± (TR)" class="border p-2 rounded" />
        <input id="editNameEN" placeholder="Product Name (EN)" class="border p-2 rounded" />
        <input id="editDesc" placeholder="AÃ§Ä±klama (TR)" class="border p-2 rounded" />
        <input id="editDescEN" placeholder="Description (EN)" class="border p-2 rounded" />
        <input id="editPrice" type="number" placeholder="Fiyat (â‚º)" class="border p-2 rounded" />
        <select id="editCategory" class="border p-2 rounded"></select>

        <button id="saveEditProduct" class="bg-green-500 text-white px-4 py-2 rounded mt-4 hover:bg-green-600 transition">DeÄŸiÅŸiklikleri Kaydet</button>
      </div>
    </div>
  </div>

  <script>
    // --- HTML Element TanÄ±mlamalarÄ± ---
    const adminLoginBtn = document.getElementById('adminLoginBtn');
    const adminPanel = document.getElementById('adminPanel');
    const editPanel = document.getElementById('editPanel');
    const checkPassword = document.getElementById('checkPassword');
    const passwordInput = document.getElementById('passwordInput');
    const loginError = document.getElementById('loginError');
    const closeAdmin = document.getElementById('closeAdmin');
    const closeEdit = document.getElementById('closeEdit');
    const menuContainer = document.getElementById('menuContainer');
    const productList = document.getElementById('productList');
    const contactSection = document.getElementById('contactSection');
    const tabButtonsContainer = document.getElementById('categoryTabs');
    const imageModal = document.getElementById('imageModal');
    const modalImage = document.getElementById('modalImage');
    const langTR = document.getElementById('langTR');
    const langEN = document.getElementById('langEN');
    const contactTitle = document.getElementById('contactTitle');
    const contactAddress = document.getElementById('contactAddress');
    const adminLoginButton = document.getElementById('adminLoginBtn');

    // Yeni ÃœrÃ¼n Ekleme Elementleri
    const productNameInput = document.getElementById('productName');
    const productDescInput = document.getElementById('productDesc');
    const productDescENInput = document.getElementById('productDescEN');
    const productPriceInput = document.getElementById('productPrice');
    const productImageFileInput = document.getElementById('productImageFile');
    const productCategorySelect = document.getElementById('productCategory');
    const addProductButton = document.getElementById('addProduct');
    const filterCategorySelect = document.getElementById('filterCategory');

    // ÃœRÃœN DÃœZENLEME MODAL Elementleri
    const editProductModal = document.getElementById('editProductModal');
    const closeEditProductModal = document.getElementById('closeEditProductModal');
    const editProductIndexInput = document.getElementById('editProductIndex');
    const editNameInput = document.getElementById('editName');
    const editNameENInput = document.getElementById('editNameEN');
    const editDescInput = document.getElementById('editDesc');
    const editDescENInput = document.getElementById('editDescEN');
    const editPriceInput = document.getElementById('editPrice');
    const editCategorySelect = document.getElementById('editCategory');
    const saveEditProductButton = document.getElementById('saveEditProduct');
    
    // GÃ–RSEL DÃœZENLEME ELEMENTLERÄ°
    const editImagePreview = document.getElementById('editImagePreview');
    const editImageURLInput = document.getElementById('editImageURL');
    const editImageFile = document.getElementById('editImageFile');


    let language = 'TR'; // VarsayÄ±lan dil TÃ¼rkÃ§e
    let products = []; // ÃœrÃ¼nler artÄ±k API'dan Ã§ekilecek

    // Kategori Ã§evirileri
    const categoryTranslations = {
      'TÃ¼mÃ¼': 'All',
      'MenÃ¼ler': 'Menus',
      'KokoreÃ§': 'KokoreÃ§',
      'Tavuk DÃ¶ner': 'Chicken DÃ¶ner',
      'KÃ¶fte': 'Meatballs',
      'CiÄŸer': 'Liver',
      'Hamburger': 'Hamburger',
      'Yan Lezzetler': 'Side Dishes',
      'Ä°Ã§ecekler': 'Drinks',
      'Ä°letiÅŸim': 'Contact'
    };

    let categoriesTR = Object.keys(categoryTranslations);
    let categoriesEN = Object.values(categoryTranslations);

    // --- MOCK API (Bulut/Sunucu SimÃ¼lasyonu) ---
    
    // BaÅŸlangÄ±Ã§ verileri (Bu veriler, sayfa her yÃ¼klendiÄŸinde simÃ¼lasyon sunucusu gÃ¶revi gÃ¶ren
    // localStorage'a kaydedilir. GerÃ§ek bir senaryoda bu verilere doÄŸrudan DB'den ulaÅŸÄ±lÄ±r.)
    const initialProducts = [
      {id: 1, name:'KokoreÃ§ Ekmek ArasÄ±',nameEN:'KokoreÃ§ Sandwich',desc:'Izgara kokoreÃ§, baharatlÄ±',descEN:'Grilled kokoreÃ§, seasoned with spices',price:150,image:'https://images.unsplash.com/photo-1608032156297-6b1c7b7a6a64',category:'KokoreÃ§'},
      {id: 2, name:'YarÄ±m Ekmek KÃ¶fte',nameEN:'Half Bread Meatball',desc:'Izgarada nefis kasap kÃ¶ftesi',descEN:'Delicious butcher meatballs on the grill',price:180,image:'https://images.unsplash.com/photo-1544025166-0a30b999e485',category:'KÃ¶fte'},
      {id: 3, name:'Tavuk DÃ¶ner DÃ¼rÃ¼m',nameEN:'Chicken DÃ¶ner Wrap',desc:'Taze lavaÅŸta tavuk dÃ¶ner',descEN:'Chicken dÃ¶ner in fresh lavash wrap',price:90,image:'https://images.unsplash.com/photo-1617196034796-73bf8b2f1d1a',category:'Tavuk DÃ¶ner'},
      {id: 4, name:'Klasik Hamburger MenÃ¼',nameEN:'Classic Hamburger Menu',desc:'Ev yapÄ±mÄ± kÃ¶fte, patates ve iÃ§ecek',descEN:'Homemade patty, fries and a drink',price:130,image:'https://images.unsplash.com/photo-1568901346375-23c9450c58cd',category:'Hamburger'}
    ];
    
    function getProductsFromMockDB() {
        // GerÃ§ek bir senaryoda bu bir fetch('/api/products') Ã§aÄŸrÄ±sÄ± olurdu.
        // SimÃ¼lasyon iÃ§in localStorage'Ä± "Mock DB" olarak kullanÄ±yoruz.
        const stored = localStorage.getItem('mockDB_products');
        return stored ? JSON.parse(stored) : initialProducts;
    }

    function saveProductsToMockDB(data) {
        // GerÃ§ek bir senaryoda bu bir veritabanÄ± yazma iÅŸlemi olurdu.
        localStorage.setItem('mockDB_products', JSON.stringify(data));
    }
    
    // ÃœrÃ¼nleri okuma (GET) simÃ¼lasyonu
    async function fetchProducts() {
        // GerÃ§ek API gecikmesini simÃ¼le etmek iÃ§in bir bekleme ekleyelim
        await new Promise(resolve => setTimeout(resolve, 300)); 
        products = getProductsFromMockDB();
        return products;
    }

    // ÃœrÃ¼n kaydetme (POST) simÃ¼lasyonu
    async function saveProduct(product) {
        await new Promise(resolve => setTimeout(resolve, 100));
        let currentProducts = getProductsFromMockDB();
        
        let nextId = currentProducts.length > 0 ? Math.max(...currentProducts.map(p => p.id)) + 1 : 1;
        product.id = nextId;
        
        currentProducts.push(product);
        saveProductsToMockDB(currentProducts);
        
        return product; // Kaydedilen Ã¼rÃ¼nÃ¼ geri dÃ¶ndÃ¼r
    }

    // ÃœrÃ¼n gÃ¼ncelleme (PUT) simÃ¼lasyonu
    async function updateProduct(updatedProduct) {
        await new Promise(resolve => setTimeout(resolve, 100));
        let currentProducts = getProductsFromMockDB();
        
        const index = currentProducts.findIndex(p => p.id === updatedProduct.id);
        if (index > -1) {
            currentProducts[index] = updatedProduct;
            saveProductsToMockDB(currentProducts);
            return updatedProduct;
        }
        throw new Error("GÃ¼ncellenecek Ã¼rÃ¼n bulunamadÄ±!");
    }

    // ÃœrÃ¼n silme (DELETE) simÃ¼lasyonu
    async function deleteProduct(productId) {
        await new Promise(resolve => setTimeout(resolve, 100));
        let currentProducts = getProductsFromMockDB();
        
        const index = currentProducts.findIndex(p => p.id === productId);
        if (index > -1) {
            currentProducts.splice(index, 1);
            saveProductsToMockDB(currentProducts);
            return true;
        }
        return false;
    }

    // --- Uygulama MantÄ±ÄŸÄ± ---

    // Bu fonksiyon, menÃ¼yÃ¼ ve admin panelini API'dan gelen en son verilere gÃ¶re yeniden yÃ¼kler
    async function refreshAppUI() {
        await fetchProducts(); // Veriyi "buluttan" Ã§ek
        
        updateLanguageContent();
        
        // Admin paneli aÃ§Ä±ksa, listeyi de gÃ¼ncelle
        if (!editPanel.classList.contains('hidden')) {
             renderEditList(filterCategorySelect.value);
        }
    }


    // Kategori sekmelerini oluÅŸturur ve aktif dile gÃ¶re isimlerini ayarlar
    function createCategoryTabs(){
      tabButtonsContainer.innerHTML = '';
      const categoriesToIterate = categoriesTR;

      categoriesToIterate.forEach((catTR, index) => {
        let btn = document.createElement('button');
        const catName = language === 'TR' ? catTR : categoriesEN[index];

        btn.className='tabBtn px-3 py-1 rounded whitespace-nowrap transition-colors duration-150 hover:bg-orange-200';
        btn.dataset.category=catTR;
        btn.textContent=catName;

        if(catTR==='TÃ¼mÃ¼') {
             btn.classList.add('active-tab');
        }

        btn.addEventListener('click',()=>{
          document.querySelectorAll('.tabBtn').forEach(b=>b.classList.remove('active-tab'));
          btn.classList.add('active-tab');
          const categoryKey = btn.dataset.category;

          if(categoryKey==='Ä°letiÅŸim'){
            menuContainer.innerHTML='';
            contactSection.classList.remove('hidden');
          } else {
            contactSection.classList.add('hidden');
            renderMenu(categoryKey);
          }
        });
        tabButtonsContainer.appendChild(btn);
      });
    }

    // MenÃ¼ kartlarÄ±nÄ± render eder
    function renderMenu(category='TÃ¼mÃ¼'){
      menuContainer.innerHTML='';
      const filtered = category==='TÃ¼mÃ¼'?products:products.filter(p=>p.category===category);

      filtered.forEach(p=>{
        const card=document.createElement('div');
        card.className='bg-white rounded-xl shadow p-4 flex flex-col hover:shadow-lg transition-shadow duration-200';
        
        const name = language==='TR'?p.name:p.nameEN||p.name;
        const desc = language==='TR'?p.desc:p.descEN||p.desc||'';

        card.innerHTML=`
          <img src='${p.image}' alt='${name}' class='w-full h-40 object-cover rounded-lg mb-3 cursor-pointer'>
          <h3 class='font-bold text-xl mb-1'>${name}</h3>
          <p class='text-gray-600 text-sm mb-3 flex-grow'>${desc}</p>
          <p class='bg-orange-100 text-orange-700 inline-block px-3 py-1 rounded-full font-bold text-lg self-start'>${p.price} â‚º</p>
        `;
        card.querySelector('img').addEventListener('click',()=>{modalImage.src=p.image;imageModal.classList.remove('hidden');});
        menuContainer.appendChild(card);
      });
    }

    // --- Dil DeÄŸiÅŸtirme ve Ä°Ã§erik GÃ¼ncelleme ---

    function updateLanguageContent() {
      if (language === 'TR') {
        adminLoginButton.innerHTML = 'âš™ï¸ YÃ¶netici GiriÅŸi';
        contactTitle.textContent = 'Ä°letiÅŸim';
        contactAddress.innerHTML = 'ğŸ“ Yamanevler Mah. AlemdaÄŸ Caddesi No 159 D<br>Olimpiyat KokoreÃ§ Ãœmraniye - Ä°stanbul';
        langTR.style.fontWeight = 'bold';
        langEN.style.fontWeight = 'normal';
      } else { 
        adminLoginButton.innerHTML = 'âš™ï¸ Admin Login';
        contactTitle.textContent = 'Contact';
        contactAddress.innerHTML = 'ğŸ“ Yamanevler Mah. AlemdaÄŸ Caddesi No 159 D<br>Olimpiyat KokoreÃ§ Ãœmraniye - Istanbul (Turkey)';
        langTR.style.fontWeight = 'normal';
        langEN.style.fontWeight = 'bold';
      }

      createCategoryTabs();
      const activeTab = document.querySelector('.tabBtn.active-tab');
      const activeCategoryKey = activeTab ? activeTab.dataset.category : 'TÃ¼mÃ¼';
      
      if (activeCategoryKey === 'Ä°letiÅŸim') {
        menuContainer.innerHTML = '';
        contactSection.classList.remove('hidden');
      } else {
        contactSection.classList.add('hidden');
        renderMenu(activeCategoryKey);
      }
    }


    langTR.addEventListener('click',()=>{
      language='TR';
      updateLanguageContent();
    });

    langEN.addEventListener('click',()=>{
      language='EN';
      updateLanguageContent();
    });

    // --- Modal YÃ¶netimi ---

    imageModal.addEventListener('click',()=>imageModal.classList.add('hidden'));

    adminLoginBtn.addEventListener('click',()=>adminPanel.classList.remove('hidden'));
    closeAdmin.addEventListener('click',()=>adminPanel.classList.add('hidden'));
    closeEdit.addEventListener('click',()=>editPanel.classList.add('hidden'));
    closeEditProductModal.addEventListener('click',()=>editProductModal.classList.add('hidden'));

    checkPassword.addEventListener('click',()=>{
      if(passwordInput.value==='admin123'){ 
        adminPanel.classList.add('hidden');
        editPanel.classList.remove('hidden');
        loginError.classList.add('hidden');
        passwordInput.value='';
        populateCategorySelects();
        renderEditList(); // Admin giriÅŸi baÅŸarÄ±lÄ±ysa listeyi yÃ¼kle
      } else {
        loginError.classList.remove('hidden');
      }
    });

    // --- YÃ¶netici ÃœrÃ¼n YÃ¶netimi ---

    function populateCategorySelects() {
      // Sadece 'MenÃ¼ler'den 'Ä°Ã§ecekler'e kadar olan kategorileri al
      const options = categoriesTR.filter(c => c !== 'TÃ¼mÃ¼' && c !== 'Ä°letiÅŸim');
      
      [productCategorySelect, filterCategorySelect, editCategorySelect].forEach(select => {
        select.innerHTML = ''; 
        options.forEach(cat => {
          const option = document.createElement('option');
          option.textContent = cat;
          select.appendChild(option);
        });
        if (select === filterCategorySelect) {
          const allOption = document.createElement('option');
          allOption.textContent = 'TÃ¼mÃ¼';
          select.insertBefore(allOption, select.firstChild);
          select.value = 'TÃ¼mÃ¼';
        }
      });
    }

    function renderEditList(filter='TÃ¼mÃ¼') {
      productList.innerHTML = '';
      const filtered = filter==='TÃ¼mÃ¼'?products:products.filter(p=>p.category===filter);

      filtered.forEach((p) => {
        const item = document.createElement('li');
        item.className = 'flex justify-between items-center bg-white p-3 rounded border shadow-sm';
        item.innerHTML = `
          <span class="font-medium text-sm">${p.name} (${p.category}) - ${p.price} â‚º</span>
          <div>
            <button data-id="${p.id}" class="editBtn bg-blue-500 text-white px-2 py-1 rounded text-xs hover:bg-blue-600 transition mr-2">DÃ¼zenle</button>
            <button data-id="${p.id}" class="deleteBtn bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600 transition">Sil</button>
          </div>
        `;
        productList.appendChild(item);
      });

      // Silme iÅŸlevi
      document.querySelectorAll('.deleteBtn').forEach(btn => {
        btn.addEventListener('click', async (e) => {
          const productIdToDelete = parseInt(e.target.dataset.id);
          
          if (confirm("Bu Ã¼rÃ¼nÃ¼ silmek istediÄŸinizden emin misiniz? (Buluttan Silinecek)")) {
              try {
                  await deleteProduct(productIdToDelete); // API Ã§aÄŸrÄ±sÄ±
                  await refreshAppUI(); // UI'Ä± yeni verilerle gÃ¼ncelle
                  alert("ÃœrÃ¼n baÅŸarÄ±yla silindi ve buluta kaydedildi.");
              } catch (error) {
                  alert("Silme iÅŸlemi baÅŸarÄ±sÄ±z oldu: " + error.message);
              }
          }
        });
      });

      // DÃœZENLEME Ä°ÅLEVÄ°
      document.querySelectorAll('.editBtn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const productIdToEdit = parseInt(e.target.dataset.id);
          const productToEdit = products.find(p => p.id === productIdToEdit);
          
          if (productToEdit) {
            // Modal inputlarÄ±nÄ± doldur
            editProductIndexInput.value = productIdToEdit;
            editNameInput.value = productToEdit.name;
            editNameENInput.value = productToEdit.nameEN;
            editDescInput.value = productToEdit.desc;
            editDescENInput.value = productToEdit.descEN;
            editPriceInput.value = productToEdit.price;
            editCategorySelect.value = productToEdit.category;
            
            // GÃ¶rsel alanlarÄ±nÄ± doldur ve Ã¶nizlemeyi gÃ¶ster
            editImageURLInput.value = productToEdit.image;
            editImagePreview.src = productToEdit.image;
            editImageFile.value = null; // File inputunu temizle
            
            editProductModal.classList.remove('hidden');
          }
        });
      });
    }

    filterCategorySelect.addEventListener('change', (e) => {
      renderEditList(e.target.value);
    });

    // ÃœRÃœN EKLEME
    addProductButton.addEventListener('click', async () => {
      const name = productNameInput.value.trim();
      const desc = productDescInput.value.trim();
      const descEN = productDescENInput.value.trim();
      const price = parseFloat(productPriceInput.value);
      const category = productCategorySelect.value;
      const imageFile = productImageFileInput.files[0];

      if (!name || !price || !category) {
        alert('LÃ¼tfen Ã¼rÃ¼n adÄ±, fiyatÄ± ve kategoriyi giriniz.');
        return;
      }
      
      // NOT: GÃ¶rsel yÃ¼kleme sadece bir mock URL atamasÄ±dÄ±r.
      const imageURL = 'https://images.unsplash.com/photo-1543825700-6c9233634125'; 

      const newProduct = {
        name,
        nameEN: name,
        desc,
        descEN: descEN || desc,
        price,
        image: imageURL,
        category
      };

      try {
          await saveProduct(newProduct); // API (Mock) Ã§aÄŸrÄ±sÄ±
          await refreshAppUI(); // UI'Ä± yeni verilerle gÃ¼ncelle
          alert(`"${name}" Ã¼rÃ¼nÃ¼ baÅŸarÄ±yla eklendi ve buluta kaydedildi.`);

          // GiriÅŸ alanlarÄ±nÄ± temizle
          productNameInput.value = '';
          productDescInput.value = '';
          productDescENInput.value = '';
          productPriceInput.value = '';
          productImageFileInput.value = '';
          
      } catch (error) {
          alert("Ekleme iÅŸlemi baÅŸarÄ±sÄ±z oldu: " + error.message);
      }
    });
    
    // ÃœRÃœN DÃœZENLEME KAYDETME Ä°ÅLEVÄ°
    saveEditProductButton.addEventListener('click', async () => {
        const productId = parseInt(editProductIndexInput.value);
        const productToUpdate = products.find(p => p.id === productId);

        if (productToUpdate) {
            
            // --- GÃ¶rsel URL'si GÃ¼ncelleme MantÄ±ÄŸÄ± ---
            let newImageURL = productToUpdate.image; 

            if (editImageFile.files.length > 0) {
                // Mock: Dosya seÃ§ildiyse, yeni bir mock URL'si ata (GerÃ§ekte sunucuya yÃ¼klenir)
                newImageURL = URL.createObjectURL(editImageFile.files[0]); 
            } else if (editImageURLInput.value.trim() !== '') {
                // Dosya seÃ§ilmediyse ve URL alanÄ± doluysa, URL'yi kullan
                newImageURL = editImageURLInput.value.trim();
            }

            // ÃœrÃ¼nÃ¼ gÃ¼ncelleme iÃ§in hazÄ±rlar
            const updatedProduct = {
                id: productId,
                name: editNameInput.value.trim(),
                nameEN: editNameENInput.value.trim(),
                desc: editDescInput.value.trim(),
                descEN: editDescENInput.value.trim(),
                price: parseFloat(editPriceInput.value),
                category: editCategorySelect.value,
                image: newImageURL
            };
            
            try {
                await updateProduct(updatedProduct); // API (Mock) Ã§aÄŸrÄ±sÄ±
                editProductModal.classList.add('hidden');
                await refreshAppUI(); // UI'Ä± yeni verilerle gÃ¼ncelle
                alert(`"${updatedProduct.name}" Ã¼rÃ¼nÃ¼ baÅŸarÄ±yla gÃ¼ncellendi ve buluta kaydedildi.`);
            } catch (error) {
                alert("GÃ¼ncelleme iÅŸlemi baÅŸarÄ±sÄ±z oldu: " + error.message);
            }

        } else {
            alert('Hata: ÃœrÃ¼n bulunamadÄ±!');
        }
    });


    // --- Ä°lk YÃ¼kleme ---
    document.addEventListener('DOMContentLoaded', () => {
      refreshAppUI(); // Sayfa yÃ¼klendiÄŸinde veriyi buluttan Ã§ek ve UI'Ä± hazÄ±rla
    });
  </script>
</body>
</html>
