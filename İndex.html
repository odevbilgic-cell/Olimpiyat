<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Olimpiyat Kokore√ß Men√º</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background-color: #fff7f0; }
    .active-tab { background-color: #fb923c; color: white; }
    /* Men√º sekmelerinin g√∂r√ºn√ºm√º i√ßin kaydƒ±rma √ßubuƒüunu gizle */
    #categoryTabs::-webkit-scrollbar { display: none; }
    #categoryTabs { -ms-overflow-style: none; /* IE and Edge */ scrollbar-width: none; /* Firefox */ }
  </style>
</head>
<body class="text-gray-800">
  <header class="bg-orange-500 text-white p-4 flex justify-between items-center sticky top-0 z-10 shadow-md">
    <h1 class="text-2xl font-bold">Olimpiyat Kokore√ß</h1>
    <div class="flex items-center gap-2">
      <button id="langTR" class="bg-white text-orange-600 px-3 py-1 rounded font-bold">TR</button>
      <button id="langEN" class="bg-white text-orange-600 px-3 py-1 rounded">EN</button>
      <button id="adminLoginBtn" class="bg-white text-orange-600 px-3 py-1 rounded">‚öôÔ∏è Y√∂netici Giri≈üi</button>
    </div>
  </header>

  <nav id="categoryTabs" class="flex overflow-x-auto bg-white shadow p-2 space-x-2 text-sm font-semibold sticky top-[64px] z-10"></nav>

  <main class="p-4">
    <div id="menuContainer" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
        </div>

    <div id="contactSection" class="hidden text-center mt-6 bg-white rounded-xl shadow p-6 max-w-lg mx-auto">
      <h2 id="contactTitle" class="text-2xl font-bold text-orange-600 mb-3">ƒ∞leti≈üim</h2>
      <p id="contactAddress" class="mb-3">üìç Yamanevler Mah. Alemdaƒü Caddesi No 159 D<br>Olimpiyat Kokore√ß √úmraniye - ƒ∞stanbul</p>
      <p class="mt-2">üìû <a href="tel:02163357920" id="contactPhone" class="text-orange-600 font-semibold text-lg hover:underline">0216 335 79 20</a></p>
    </div>
  </main>

  <div id="imageModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex justify-center items-center z-50 transition-opacity">
    <img id="modalImage" class="max-h-[90vh] max-w-[90vw] rounded-xl shadow-2xl transition-transform">
  </div>

  <div id="adminPanel" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50">
    <div class="bg-white rounded-xl shadow-lg p-6 w-96 relative">
      <button id="closeAdmin" class="absolute top-2 right-2 text-gray-500 hover:text-gray-800">‚úñ</button>
      <h2 class="text-xl font-bold mb-3 text-orange-600">Y√∂netici Giri≈üi</h2>
      <input id="passwordInput" type="password" placeholder="≈ûifreyi giriniz" class="border w-full p-2 rounded mb-3 focus:ring-orange-500 focus:border-orange-500" />
      <button id="checkPassword" class="bg-orange-500 text-white px-4 py-2 rounded w-full hover:bg-orange-600 transition">Giri≈ü Yap</button>
      <p id="loginError" class="text-red-600 text-sm mt-2 hidden">Hatalƒ± ≈üifre!</p>
    </div>
  </div>

  <div id="editPanel" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50">
    <div class="bg-white rounded-xl shadow-lg p-6 w-[600px] relative max-h-[90vh] overflow-y-auto">
      <button id="closeEdit" class="absolute top-2 right-2 text-gray-500 hover:text-gray-800">‚úñ</button>
      <h2 class="text-xl font-bold mb-3 text-orange-600">√úr√ºn Y√∂netimi</h2>
      
      <div class="flex flex-col gap-2 mb-4 p-4 border rounded-lg bg-orange-50">
        <h3 class="font-bold text-lg mb-1">Yeni √úr√ºn Ekle</h3>
        <input id="productName" placeholder="√úr√ºn Adƒ± (TR)" class="border p-2 rounded" />
        <input id="productDesc" placeholder="A√ßƒ±klama (TR)" class="border p-2 rounded" />
        <input id="productDescEN" placeholder="A√ßƒ±klama (EN)" class="border p-2 rounded" />
        <input id="productPrice" type="number" placeholder="Fiyat (‚Ç∫)" class="border p-2 rounded" />
        <input id="productImageFile" type="file" accept="image/*" class="border p-2 rounded bg-white" />
        <select id="productCategory" class="border p-2 rounded">
          </select>
        <button id="addProduct" class="bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 transition">√úr√ºn Ekle</button>
      </div>

      <h3 class="font-semibold mb-2">Mevcut √úr√ºnler</h3>
      <div class="flex gap-2 mb-2">
        <select id="filterCategory" class="border p-2 rounded flex-1"></select>
      </div>
      <ul id="productList" class="flex flex-col gap-2"></ul>
    </div>
  </div>

  <div id="editProductModal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50">
    <div class="bg-white rounded-xl shadow-lg p-6 w-[500px] relative max-h-[90vh] overflow-y-auto">
      <button id="closeEditProductModal" class="absolute top-2 right-2 text-gray-500 hover:text-gray-800">‚úñ</button>
      <h2 class="text-xl font-bold mb-3 text-orange-600">√úr√ºn D√ºzenle</h2>
      
      <input type="hidden" id="editProductIndex" />
      
      <div class="flex flex-col gap-3">
        
        <div class="p-3 border rounded-lg bg-gray-50">
            <h3 class="font-semibold mb-2">G√∂rsel D√ºzenleme</h3>
            <img id="editImagePreview" class="w-full h-32 object-cover rounded-lg mb-2 border border-gray-300" src="" alt="√úr√ºn G√∂rseli √ñnizleme">
            
            <label class="block text-sm font-medium mb-1">Yeni G√∂rsel URL'si:</label>
            <input id="editImageURL" placeholder="Yeni G√∂rsel URL'si girin" class="border w-full p-2 rounded mb-2 text-sm" />

            <label class="block text-sm font-medium mb-1">Veya Yeni G√∂rsel Y√ºkle:</label>
            <input id="editImageFile" type="file" accept="image/*" class="border w-full p-1 rounded bg-white text-sm" />
            <p class="text-xs text-gray-500 mt-1">Dosya se√ßilirse URL alanƒ± yok sayƒ±lƒ±r.</p>
        </div>

        <input id="editName" placeholder="√úr√ºn Adƒ± (TR)" class="border p-2 rounded" />
        <input id="editNameEN" placeholder="Product Name (EN)" class="border p-2 rounded" />
        <input id="editDesc" placeholder="A√ßƒ±klama (TR)" class="border p-2 rounded" />
        <input id="editDescEN" placeholder="Description (EN)" class="border p-2 rounded" />
        <input id="editPrice" type="number" placeholder="Fiyat (‚Ç∫)" class="border p-2 rounded" />
        <select id="editCategory" class="border p-2 rounded"></select>

        <button id="saveEditProduct" class="bg-green-500 text-white px-4 py-2 rounded mt-4 hover:bg-green-600 transition">Deƒüi≈üiklikleri Kaydet</button>
      </div>
    </div>
  </div>

  <script>
    // --- HTML Element Tanƒ±mlamalarƒ± ---
    const adminLoginBtn = document.getElementById('adminLoginBtn');
    const adminPanel = document.getElementById('adminPanel');
    const editPanel = document.getElementById('editPanel');
    const checkPassword = document.getElementById('checkPassword');
    const passwordInput = document.getElementById('passwordInput');
    const loginError = document.getElementById('loginError');
    const closeAdmin = document.getElementById('closeAdmin');
    const closeEdit = document.getElementById('closeEdit');
    const menuContainer = document.getElementById('menuContainer');
    const productList = document.getElementById('productList');
    const contactSection = document.getElementById('contactSection');
    const tabButtonsContainer = document.getElementById('categoryTabs');
    const imageModal = document.getElementById('imageModal');
    const modalImage = document.getElementById('modalImage');
    const langTR = document.getElementById('langTR');
    const langEN = document.getElementById('langEN');
    const contactTitle = document.getElementById('contactTitle');
    const contactAddress = document.getElementById('contactAddress');
    const adminLoginButton = document.getElementById('adminLoginBtn');

    // Yeni √úr√ºn Ekleme Elementleri
    const productNameInput = document.getElementById('productName');
    const productDescInput = document.getElementById('productDesc');
    const productDescENInput = document.getElementById('productDescEN');
    const productPriceInput = document.getElementById('productPrice');
    const productImageFileInput = document.getElementById('productImageFile');
    const productCategorySelect = document.getElementById('productCategory');
    const addProductButton = document.getElementById('addProduct');
    const filterCategorySelect = document.getElementById('filterCategory');

    // √úR√úN D√úZENLEME MODAL Elementleri
    const editProductModal = document.getElementById('editProductModal');
    const closeEditProductModal = document.getElementById('closeEditProductModal');
    const editProductIndexInput = document.getElementById('editProductIndex');
    const editNameInput = document.getElementById('editName');
    const editNameENInput = document.getElementById('editNameEN');
    const editDescInput = document.getElementById('editDesc');
    const editDescENInput = document.getElementById('editDescEN');
    const editPriceInput = document.getElementById('editPrice');
    const editCategorySelect = document.getElementById('editCategory');
    const saveEditProductButton = document.getElementById('saveEditProduct');
    
    // G√ñRSEL D√úZENLEME ELEMENTLERƒ∞
    const editImagePreview = document.getElementById('editImagePreview');
    const editImageURLInput = document.getElementById('editImageURL');
    const editImageFile = document.getElementById('editImageFile');


    let language = 'TR'; // Varsayƒ±lan dil T√ºrk√ße
    let products = []; // √úr√ºnler artƒ±k API'dan √ßekilecek

    // Kategori √ßevirileri
    const categoryTranslations = {
      'T√ºm√º': 'All',
      'Men√ºler': 'Menus',
      'Kokore√ß': 'Kokore√ß',
      'Tavuk D√∂ner': 'Chicken D√∂ner',
      'K√∂fte': 'Meatballs',
      'Ciƒüer': 'Liver',
      'Hamburger': 'Hamburger',
      'Yan Lezzetler': 'Side Dishes',
      'ƒ∞√ßecekler': 'Drinks',
      'ƒ∞leti≈üim': 'Contact'
    };

    let categoriesTR = Object.keys(categoryTranslations);
    let categoriesEN = Object.values(categoryTranslations);

    // --- MOCK API (Bulut/Sunucu Sim√ºlasyonu) ---
    
    // Ba≈ülangƒ±√ß verileri (Bu veriler, sayfa her y√ºklendiƒüinde sim√ºlasyon sunucusu g√∂revi g√∂ren
    // localStorage'a kaydedilir. Ger√ßek bir senaryoda bu verilere doƒürudan DB'den ula≈üƒ±lƒ±r.)
    const initialProducts = [
      {id: 1, name:'Kokore√ß Ekmek Arasƒ±',nameEN:'Kokore√ß Sandwich',desc:'Izgara kokore√ß, baharatlƒ±',descEN:'Grilled kokore√ß, seasoned with spices',price:150,image:'https://images.unsplash.com/photo-1608032156297-6b1c7b7a6a64',category:'Kokore√ß'},
      {id: 2, name:'Yarƒ±m Ekmek K√∂fte',nameEN:'Half Bread Meatball',desc:'Izgarada nefis kasap k√∂ftesi',descEN:'Delicious butcher meatballs on the grill',price:180,image:'https://images.unsplash.com/photo-1544025166-0a30b999e485',category:'K√∂fte'},
      {id: 3, name:'Tavuk D√∂ner D√ºr√ºm',nameEN:'Chicken D√∂ner Wrap',desc:'Taze lava≈üta tavuk d√∂ner',descEN:'Chicken d√∂ner in fresh lavash wrap',price:90,image:'https://images.unsplash.com/photo-1617196034796-73bf8b2f1d1a',category:'Tavuk D√∂ner'},
      {id: 4, name:'Klasik Hamburger Men√º',nameEN:'Classic Hamburger Menu',desc:'Ev yapƒ±mƒ± k√∂fte, patates ve i√ßecek',descEN:'Homemade patty, fries and a drink',price:130,image:'https://images.unsplash.com/photo-1568901346375-23c9450c58cd',category:'Hamburger'}
    ];
    
    function getProductsFromMockDB() {
        // Ger√ßek bir senaryoda bu bir fetch('/api/products') √ßaƒürƒ±sƒ± olurdu.
        // Sim√ºlasyon i√ßin localStorage'ƒ± "Mock DB" olarak kullanƒ±yoruz.
        const stored = localStorage.getItem('mockDB_products');
        return stored ? JSON.parse(stored) : initialProducts;
    }

    function saveProductsToMockDB(data) {
        // Ger√ßek bir senaryoda bu bir veritabanƒ± yazma i≈ülemi olurdu.
        localStorage.setItem('mockDB_products', JSON.stringify(data));
    }
    
    // √úr√ºnleri okuma (GET) sim√ºlasyonu
    async function fetchProducts() {
        // Ger√ßek API gecikmesini sim√ºle etmek i√ßin bir bekleme ekleyelim
        await new Promise(resolve => setTimeout(resolve, 300)); 
        products = getProductsFromMockDB();
        return products;
    }

    // √úr√ºn kaydetme (POST) sim√ºlasyonu
    async function saveProduct(product) {
        await new Promise(resolve => setTimeout(resolve, 100));
        let currentProducts = getProductsFromMockDB();
        
        let nextId = currentProducts.length > 0 ? Math.max(...currentProducts.map(p => p.id)) + 1 : 1;
        product.id = nextId;
        
        currentProducts.push(product);
        saveProductsToMockDB(currentProducts);
        
        return product; // Kaydedilen √ºr√ºn√º geri d√∂nd√ºr
    }

    // √úr√ºn g√ºncelleme (PUT) sim√ºlasyonu
    async function updateProduct(updatedProduct) {
        await new Promise(resolve => setTimeout(resolve, 100));
        let currentProducts = getProductsFromMockDB();
        
        const index = currentProducts.findIndex(p => p.id === updatedProduct.id);
        if (index > -1) {
            currentProducts[index] = updatedProduct;
            saveProductsToMockDB(currentProducts);
            return updatedProduct;
        }
        throw new Error("G√ºncellenecek √ºr√ºn bulunamadƒ±!");
    }

    // √úr√ºn silme (DELETE) sim√ºlasyonu
    async function deleteProduct(productId) {
        await new Promise(resolve => setTimeout(resolve, 100));
        let currentProducts = getProductsFromMockDB();
        
        const index = currentProducts.findIndex(p => p.id === productId);
        if (index > -1) {
            currentProducts.splice(index, 1);
            saveProductsToMockDB(currentProducts);
            return true;
        }
        return false;
    }

    // --- Uygulama Mantƒ±ƒüƒ± ---

    // Bu fonksiyon, men√ºy√º ve admin panelini API'dan gelen en son verilere g√∂re yeniden y√ºkler
    async function refreshAppUI() {
        await fetchProducts(); // Veriyi "buluttan" √ßek
        
        updateLanguageContent();
        
        // Admin paneli a√ßƒ±ksa, listeyi de g√ºncelle
        if (!editPanel.classList.contains('hidden')) {
             renderEditList(filterCategorySelect.value);
        }
    }


    // Kategori sekmelerini olu≈üturur ve aktif dile g√∂re isimlerini ayarlar
    function createCategoryTabs(){
      tabButtonsContainer.innerHTML = '';
      const categoriesToIterate = categoriesTR;

      categoriesToIterate.forEach((catTR, index) => {
        let btn = document.createElement('button');
        const catName = language === 'TR' ? catTR : categoriesEN[index];

        btn.className='tabBtn px-3 py-1 rounded whitespace-nowrap transition-colors duration-150 hover:bg-orange-200';
        btn.dataset.category=catTR;
        btn.textContent=catName;

        if(catTR==='T√ºm√º') {
             btn.classList.add('active-tab');
        }

        btn.addEventListener('click',()=>{
          document.querySelectorAll('.tabBtn').forEach(b=>b.classList.remove('active-tab'));
          btn.classList.add('active-tab');
          const categoryKey = btn.dataset.category;

          if(categoryKey==='ƒ∞leti≈üim'){
            menuContainer.innerHTML='';
            contactSection.classList.remove('hidden');
          } else {
            contactSection.classList.add('hidden');
            renderMenu(categoryKey);
          }
        });
        tabButtonsContainer.appendChild(btn);
      });
    }

    // Men√º kartlarƒ±nƒ± render eder
    function renderMenu(category='T√ºm√º'){
      menuContainer.innerHTML='';
      const filtered = category==='T√ºm√º'?products:products.filter(p=>p.category===category);

      filtered.forEach(p=>{
        const card=document.createElement('div');
        card.className='bg-white rounded-xl shadow p-4 flex flex-col hover:shadow-lg transition-shadow duration-200';
        
        const name = language==='TR'?p.name:p.nameEN||p.name;
        const desc = language==='TR'?p.desc:p.descEN||p.desc||'';

        card.innerHTML=`
          <img src='${p.image}' alt='${name}' class='w-full h-40 object-cover rounded-lg mb-3 cursor-pointer'>
          <h3 class='font-bold text-xl mb-1'>${name}</h3>
          <p class='text-gray-600 text-sm mb-3 flex-grow'>${desc}</p>
          <p class='bg-orange-100 text-orange-700 inline-block px-3 py-1 rounded-full font-bold text-lg self-start'>${p.price} ‚Ç∫</p>
        `;
        card.querySelector('img').addEventListener('click',()=>{modalImage.src=p.image;imageModal.classList.remove('hidden');});
        menuContainer.appendChild(card);
      });
    }

    // --- Dil Deƒüi≈ütirme ve ƒ∞√ßerik G√ºncelleme ---

    function updateLanguageContent() {
      if (language === 'TR') {
        adminLoginButton.innerHTML = '‚öôÔ∏è Y√∂netici Giri≈üi';
        contactTitle.textContent = 'ƒ∞leti≈üim';
        contactAddress.innerHTML = 'üìç Yamanevler Mah. Alemdaƒü Caddesi No 159 D<br>Olimpiyat Kokore√ß √úmraniye - ƒ∞stanbul';
        langTR.style.fontWeight = 'bold';
        langEN.style.fontWeight = 'normal';
      } else { 
        adminLoginButton.innerHTML = '‚öôÔ∏è Admin Login';
        contactTitle.textContent = 'Contact';
        contactAddress.innerHTML = 'üìç Yamanevler Mah. Alemdaƒü Caddesi No 159 D<br>Olimpiyat Kokore√ß √úmraniye - Istanbul (Turkey)';
        langTR.style.fontWeight = 'normal';
        langEN.style.fontWeight = 'bold';
      }

      createCategoryTabs();
      const activeTab = document.querySelector('.tabBtn.active-tab');
      const activeCategoryKey = activeTab ? activeTab.dataset.category : 'T√ºm√º';
      
      if (activeCategoryKey === 'ƒ∞leti≈üim') {
        menuContainer.innerHTML = '';
        contactSection.classList.remove('hidden');
      } else {
        contactSection.classList.add('hidden');
        renderMenu(activeCategoryKey);
      }
    }


    langTR.addEventListener('click',()=>{
      language='TR';
      updateLanguageContent();
    });

    langEN.addEventListener('click',()=>{
      language='EN';
      updateLanguageContent();
    });

    // --- Modal Y√∂netimi ---

    imageModal.addEventListener('click',()=>imageModal.classList.add('hidden'));

    adminLoginBtn.addEventListener('click',()=>adminPanel.classList.remove('hidden'));
    closeAdmin.addEventListener('click',()=>adminPanel.classList.add('hidden'));
    closeEdit.addEventListener('click',()=>editPanel.classList.add('hidden'));
    closeEditProductModal.addEventListener('click',()=>editProductModal.classList.add('hidden'));

    checkPassword.addEventListener('click',()=>{
      if(passwordInput.value==='admin123'){ 
        adminPanel.classList.add('hidden');
        editPanel.classList.remove('hidden');
        loginError.classList.add('hidden');
        passwordInput.value='';
        populateCategorySelects();
        renderEditList(); // Admin giri≈üi ba≈üarƒ±lƒ±ysa listeyi y√ºkle
      } else {
        loginError.classList.remove('hidden');
      }
    });

    // --- Y√∂netici √úr√ºn Y√∂netimi ---

    function populateCategorySelects() {
      // Sadece 'Men√ºler'den 'ƒ∞√ßecekler'e kadar olan kategorileri al
      const options = categoriesTR.filter(c => c !== 'T√ºm√º' && c !== 'ƒ∞leti≈üim');
      
      [productCategorySelect, filterCategorySelect, editCategorySelect].forEach(select => {
        select.innerHTML = ''; 
        options.forEach(cat => {
          const option = document.createElement('option');
          option.textContent = cat;
          select.appendChild(option);
        });
        if (select === filterCategorySelect) {
          const allOption = document.createElement('option');
          allOption.textContent = 'T√ºm√º';
          select.insertBefore(allOption, select.firstChild);
          select.value = 'T√ºm√º';
        }
      });
    }

    function renderEditList(filter='T√ºm√º') {
      productList.innerHTML = '';
      const filtered = filter==='T√ºm√º'?products:products.filter(p=>p.category===filter);

      filtered.forEach((p) => {
        const item = document.createElement('li');
        item.className = 'flex justify-between items-center bg-white p-3 rounded border shadow-sm';
        item.innerHTML = `
          <span class="font-medium text-sm">${p.name} (${p.category}) - ${p.price} ‚Ç∫</span>
          <div>
            <button data-id="${p.id}" class="editBtn bg-blue-500 text-white px-2 py-1 rounded text-xs hover:bg-blue-600 transition mr-2">D√ºzenle</button>
            <button data-id="${p.id}" class="deleteBtn bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600 transition">Sil</button>
          </div>
        `;
        productList.appendChild(item);
      });

      // Silme i≈ülevi
      document.querySelectorAll('.deleteBtn').forEach(btn => {
        btn.addEventListener('click', async (e) => {
          const productIdToDelete = parseInt(e.target.dataset.id);
          
          if (confirm("Bu √ºr√ºn√º silmek istediƒüinizden emin misiniz? (Buluttan Silinecek)")) {
              try {
                  await deleteProduct(productIdToDelete); // API √ßaƒürƒ±sƒ±
                  await refreshAppUI(); // UI'ƒ± yeni verilerle g√ºncelle
                  alert("√úr√ºn ba≈üarƒ±yla silindi ve buluta kaydedildi.");
              } catch (error) {
                  alert("Silme i≈ülemi ba≈üarƒ±sƒ±z oldu: " + error.message);
              }
          }
        });
      });

      // D√úZENLEME ƒ∞≈ûLEVƒ∞
      document.querySelectorAll('.editBtn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const productIdToEdit = parseInt(e.target.dataset.id);
          const productToEdit = products.find(p => p.id === productIdToEdit);
          
          if (productToEdit) {
            // Modal inputlarƒ±nƒ± doldur
            editProductIndexInput.value = productIdToEdit;
            editNameInput.value = productToEdit.name;
            editNameENInput.value = productToEdit.nameEN;
            editDescInput.value = productToEdit.desc;
            editDescENInput.value = productToEdit.descEN;
            editPriceInput.value = productToEdit.price;
            editCategorySelect.value = productToEdit.category;
            
            // G√∂rsel alanlarƒ±nƒ± doldur ve √∂nizlemeyi g√∂ster
            editImageURLInput.value = productToEdit.image;
            editImagePreview.src = productToEdit.image;
            editImageFile.value = null; // File inputunu temizle
            
            editProductModal.classList.remove('hidden');
          }
        });
      });
    }

    filterCategorySelect.addEventListener('change', (e) => {
      renderEditList(e.target.value);
    });

    // √úR√úN EKLEME
    addProductButton.addEventListener('click', async () => {
      const name = productNameInput.value.trim();
      const desc = productDescInput.value.trim();
      const descEN = productDescENInput.value.trim();
      const price = parseFloat(productPriceInput.value);
      const category = productCategorySelect.value;
      const imageFile = productImageFileInput.files[0];

      if (!name || !price || !category) {
        alert('L√ºtfen √ºr√ºn adƒ±, fiyatƒ± ve kategoriyi giriniz.');
        return;
      }
      
      // NOT: G√∂rsel y√ºkleme sadece bir mock URL atamasƒ±dƒ±r.
      const imageURL = 'https://images.unsplash.com/photo-1543825700-6c9233634125'; 

      const newProduct = {
        name,
        nameEN: name,
        desc,
        descEN: descEN || desc,
        price,
        image: imageURL,
        category
      };

      try {
          await saveProduct(newProduct); // API (Mock) √ßaƒürƒ±sƒ±
          await refreshAppUI(); // UI'ƒ± yeni verilerle g√ºncelle
          alert(`"${name}" √ºr√ºn√º ba≈üarƒ±yla eklendi ve buluta kaydedildi.`);

          // Giri≈ü alanlarƒ±nƒ± temizle
          productNameInput.value = '';
          productDescInput.value = '';
          productDescENInput.value = '';
          productPriceInput.value = '';
          productImageFileInput.value = '';
          
      } catch (error) {
          alert("Ekleme i≈ülemi ba≈üarƒ±sƒ±z oldu: " + error.message);
      }
    });
    
    // √úR√úN D√úZENLEME KAYDETME ƒ∞≈ûLEVƒ∞
    saveEditProductButton.addEventListener('click', async () => {
        const productId = parseInt(editProductIndexInput.value);
        const productToUpdate = products.find(p => p.id === productId);

        if (productToUpdate) {
            
            // --- G√∂rsel URL'si G√ºncelleme Mantƒ±ƒüƒ± ---
            let newImageURL = productToUpdate.image; 

            if (editImageFile.files.length > 0) {
                // Mock: Dosya se√ßildiyse, yeni bir mock URL'si ata (Ger√ßekte sunucuya y√ºklenir)
                newImageURL = URL.createObjectURL(editImageFile.files[0]); 
            } else if (editImageURLInput.value.trim() !== '') {
                // Dosya se√ßilmediyse ve URL alanƒ± doluysa, URL'yi kullan
                newImageURL = editImageURLInput.value.trim();
            }

            // √úr√ºn√º g√ºncelleme i√ßin hazƒ±rlar
            const updatedProduct = {
                id: productId,
                name: editNameInput.value.trim(),
                nameEN: editNameENInput.value.trim(),
                desc: editDescInput.value.trim(),
                descEN: editDescENInput.value.trim(),
                price: parseFloat(editPriceInput.value),
                category: editCategorySelect.value,
                image: newImageURL
            };
            
            try {
                await updateProduct(updatedProduct); // API (Mock) √ßaƒürƒ±sƒ±
                editProductModal.classList.add('hidden');
                await refreshAppUI(); // UI'ƒ± yeni verilerle g√ºncelle
                alert(`"${updatedProduct.name}" √ºr√ºn√º ba≈üarƒ±yla g√ºncellendi ve buluta kaydedildi.`);
            } catch (error) {
                alert("G√ºncelleme i≈ülemi ba≈üarƒ±sƒ±z oldu: " + error.message);
            }

        } else {
            alert('Hata: √úr√ºn bulunamadƒ±!');
        }
    });


    // --- ƒ∞lk Y√ºkleme ---
    document.addEventListener('DOMContentLoaded', () => {
      refreshAppUI(); // Sayfa y√ºklendiƒüinde veriyi buluttan √ßek ve UI'ƒ± hazƒ±rla
    });
  </script>
</body>
</html>
