<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Olimpiyat Kokore√ß Men√º</title>
  <script src="https://cdn.tailwindcss.com"></script>
  
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  
  <script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>

  <style>
    body { background-color: #fff7f0; }
    .active-tab { background-color: #fb923c; color: white; }
    #categoryTabs::-webkit-scrollbar { display: none; }
    #categoryTabs { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body class="text-gray-800">
  <header class="bg-orange-500 text-white p-4 flex justify-between items-center sticky top-0 z-10 shadow-md">
    <h1 class="text-2xl font-bold">Olimpiyat Kokore√ß</h1>
    <div class="flex items-center gap-2">
      <button id="langTR" class="bg-white text-orange-600 px-3 py-1 rounded font-bold">TR</button>
      <button id="langEN" class="bg-white text-orange-600 px-3 py-1 rounded">EN</button>
      <button id="adminLoginBtn" class="bg-white text-orange-600 px-3 py-1 rounded">‚öôÔ∏è Y√∂netici Giri≈üi</button>
    </div>
  </header>

  <nav id="categoryTabs" class="flex overflow-x-auto bg-white shadow p-2 space-x-2 text-sm font-semibold sticky top-[64px] z-10"></nav>

  <main class="p-4">
    <div id="menuContainer" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>

    <div id="contactSection" class="hidden text-center mt-6 bg-white rounded-xl shadow p-6 max-w-lg mx-auto">
      <h2 id="contactTitle" class="text-2xl font-bold text-orange-600 mb-3">ƒ∞leti≈üim</h2>
      <p id="contactAddress" class="mb-3">üìç Yamanevler Mah. Alemdaƒü Caddesi No 159 D<br>Olimpiyat Kokore√ß √úmraniye - ƒ∞stanbul</p>
      <p class="mt-2">üìû <a href="tel:02163357920" id="contactPhone" class="text-orange-600 font-semibold text-lg hover:underline">0216 335 79 20</a></p>
    </div>
  </main>

  <div id="imageModal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex justify-center items-center z-50 transition-opacity">
    <img id="modalImage" class="max-h-[90vh] max-w-[90vw] rounded-xl shadow-2xl transition-transform">
  </div>

  <div id="adminPanel" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50">
    <div class="bg-white rounded-xl shadow-lg p-6 w-96 relative">
      <button id="closeAdmin" class="absolute top-2 right-2 text-gray-500 hover:text-gray-800">‚úñ</button>
      <h2 class="text-xl font-bold mb-3 text-orange-600">Y√∂netici Giri≈üi</h2>
      <input id="passwordInput" type="password" placeholder="≈ûifreyi giriniz" class="border w-full p-2 rounded mb-3 focus:ring-orange-500 focus:border-orange-500" />
      <button id="checkPassword" class="bg-orange-500 text-white px-4 py-2 rounded w-full hover:bg-orange-600 transition">Giri≈ü Yap</button>
      <p id="loginError" class="text-red-600 text-sm mt-2 hidden">Hatalƒ± ≈üifre!</p>
    </div>
  </div>

  <div id="editPanel" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50">
    <div class="bg-white rounded-xl shadow-lg p-6 w-[600px] relative max-h-[90vh] overflow-y-auto">
      <button id="closeEdit" class="absolute top-2 right-2 text-gray-500 hover:text-gray-800">‚úñ</button>
      <h2 class="text-xl font-bold mb-3 text-orange-600">√úr√ºn Y√∂netimi</h2>
      
      <div class="flex flex-col gap-2 mb-4 p-4 border rounded-lg bg-orange-50">
        <h3 class="font-bold text-lg mb-1">Yeni √úr√ºn Ekle</h3>
        <input id="productName" placeholder="√úr√ºn Adƒ± (TR)" class="border p-2 rounded" />
        <input id="productDesc" placeholder="A√ßƒ±klama (TR)" class="border p-2 rounded" />
        <input id="productDescEN" placeholder="A√ßƒ±klama (EN)" class="border p-2 rounded" />
        <input id="productPrice" type="number" placeholder="Fiyat (‚Ç∫)" class="border p-2 rounded" />
        
        <div class="p-3 border rounded-lg bg-gray-50">
            <h3 class="font-semibold mb-2">G√∂rsel Y√ºkle</h3>
            <button id="uploadNewImageBtn" class="bg-blue-500 text-white px-4 py-2 rounded text-sm hover:bg-blue-600 transition w-full">G√∂rsel Y√ºkle (Pop-up A√ßƒ±lacak)</button>
            <img id="newImagePreview" class="w-full h-32 object-cover rounded-lg mt-2 border border-gray-300 hidden" src="https://images.unsplash.com/photo-1543825700-6c9233634125" alt="Yeni G√∂rsel √ñnizleme">
            <input type="hidden" id="productImageURL" value="https://images.unsplash.com/photo-1543825700-6c9233634125" />
        </div>
        
        <select id="productCategory" class="border p-2 rounded"></select>
        <button id="addProduct" class="bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 transition">√úr√ºn Ekle</button>
      </div>

      <h3 class="font-semibold mb-2">Mevcut √úr√ºnler</h3>
      <div class="flex gap-2 mb-2">
        <select id="filterCategory" class="border p-2 rounded flex-1"></select>
      </div>
      <ul id="productList" class="flex flex-col gap-2"></ul>
    </div>
  </div>

  <div id="editProductModal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50">
    <div class="bg-white rounded-xl shadow-lg p-6 w-[500px] relative max-h-[90vh] overflow-y-auto">
      <button id="closeEditProductModal" class="absolute top-2 right-2 text-gray-500 hover:text-gray-800">‚úñ</button>
      <h2 class="text-xl font-bold mb-3 text-orange-600">√úr√ºn D√ºzenle</h2>
      
      <input type="hidden" id="editProductKey" />
      
      <div class="flex flex-col gap-3">
        
        <div class="p-3 border rounded-lg bg-gray-50">
            <h3 class="font-semibold mb-2">G√∂rsel D√ºzenleme</h3>
            <img id="editImagePreview" class="w-full h-32 object-cover rounded-lg mb-2 border border-gray-300" src="" alt="√úr√ºn G√∂rseli √ñnizleme">
            <button id="uploadEditImageBtn" class="bg-blue-500 text-white px-4 py-2 rounded text-sm hover:bg-blue-600 transition w-full">Yeni G√∂rsel Y√ºkle (Pop-up A√ßƒ±lacak)</button>
            <input type="hidden" id="editImageURL" value="" />
        </div>

        <input id="editName" placeholder="√úr√ºn Adƒ± (TR)" class="border p-2 rounded" />
        <input id="editNameEN" placeholder="Product Name (EN)" class="border p-2 rounded" />
        <input id="editDesc" placeholder="A√ßƒ±klama (TR)" class="border p-2 rounded" />
        <input id="editDescEN" placeholder="Description (EN)" class="border p-2 rounded" />
        <input id="editPrice" type="number" placeholder="Fiyat (‚Ç∫)" class="border p-2 rounded" />
        <select id="editCategory" class="border p-2 rounded"></select>

        <button id="saveEditProduct" class="bg-green-500 text-white px-4 py-2 rounded mt-4 hover:bg-green-600 transition">Deƒüi≈üiklikleri Kaydet</button>
      </div>
    </div>
  </div>

  <script>
    // --- Firebase Yapƒ±landƒ±rmasƒ± (D√úZELTƒ∞LMƒ∞≈û URL) ---
    const firebaseConfig = {
        apiKey: "AIzaSyDcYNF0hMow-y1MuV3GXLG9vY_MK0tJTGs",
        authDomain: "olimpiyatkokorecmenu.firebaseapp.com",
        projectId: "olimpiyatkokorecmenu",
        messagingSenderId: "987017604417",
        appId: "1:987017604417:web:b6c4858712dc66d14745c0",
        measurementId: "G-HB0J7BFZ9N",
        // D√úZELTƒ∞LMƒ∞≈û DATABASE URL (B√∂lgesel uyarƒ±yƒ± √ß√∂zer)
        databaseURL: "https://olimpiyatkokorecmenu-default-rtdb.europe-west1.firebasedatabase.app"
    };

    // CLOUDINARY Bƒ∞LGƒ∞LERƒ∞ (Sizin Tarafƒ±nƒ±zdan Girildi)
    const CLOUDINARY_CLOUD_NAME = 'dtkrwqofx';      
    const CLOUDINARY_UPLOAD_PRESET = 'olimpiyat_menu'; 

    // Firebase'i ba≈ülat
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const productsRef = database.ref('products');

    // --- HTML Element Tanƒ±mlamalarƒ± ---
    const adminLoginBtn = document.getElementById('adminLoginBtn');
    const adminPanel = document.getElementById('adminPanel');
    const editPanel = document.getElementById('editPanel');
    const checkPassword = document.getElementById('checkPassword');
    const passwordInput = document.getElementById('passwordInput');
    const loginError = document.getElementById('loginError');
    const closeAdmin = document.getElementById('closeAdmin');
    const closeEdit = document.getElementById('closeEdit');
    const menuContainer = document.getElementById('menuContainer');
    const productList = document.getElementById('productList');
    const contactSection = document.getElementById('contactSection');
    const imageModal = document.getElementById('imageModal');
    const modalImage = document.getElementById('modalImage');
    const langTR = document.getElementById('langTR');
    const langEN = document.getElementById('langEN');
    const contactTitle = document.getElementById('contactTitle');
    const contactAddress = document.getElementById('contactAddress');
    const adminLoginButton = document.getElementById('adminLoginBtn');
    const tabButtonsContainer = document.getElementById('categoryTabs');
    const productNameInput = document.getElementById('productName');
    const productDescInput = document.getElementById('productDesc');
    const productDescENInput = document.getElementById('productDescEN');
    const productPriceInput = document.getElementById('productPrice');
    const productImageURLInput = document.getElementById('productImageURL'); 
    const productCategorySelect = document.getElementById('productCategory');
    const addProductButton = document.getElementById('addProduct');
    const filterCategorySelect = document.getElementById('filterCategory');
    const editProductModal = document.getElementById('editProductModal');
    const closeEditProductModal = document.getElementById('closeEditProductModal');
    const editProductKeyInput = document.getElementById('editProductKey'); 
    const editNameInput = document.getElementById('editName');
    const editNameENInput = document.getElementById('editNameEN');
    const editDescInput = document.getElementById('editDesc');
    const editDescENInput = document.getElementById('editDescEN');
    const editPriceInput = document.getElementById('editPrice');
    const editCategorySelect = document.getElementById('editCategory');
    const saveEditProductButton = document.getElementById('saveEditProduct');
    const editImagePreview = document.getElementById('editImagePreview');
    const editImageURLInput = document.getElementById('editImageURL');
    const uploadNewImageBtn = document.getElementById('uploadNewImageBtn'); 
    const uploadEditImageBtn = document.getElementById('uploadEditImageBtn'); 
    const newImagePreview = document.getElementById('newImagePreview'); 
    
    let language = 'TR'; 
    let products = []; 

    // Kategori √ßevirileri
    const categoryTranslations = {
      'T√ºm√º': 'All', 'Men√ºler': 'Menus', 'Kokore√ß': 'Kokore√ß', 'Tavuk D√∂ner': 'Chicken D√∂ner',
      'K√∂fte': 'Meatballs', 'Ciƒüer': 'Liver', 'Hamburger': 'Hamburger',
      'Yan Lezzetler': 'Side Dishes', 'ƒ∞√ßecekler': 'Drinks', 'ƒ∞leti≈üim': 'Contact'
    };

    let categoriesTR = Object.keys(categoryTranslations);
    let categoriesEN = Object.values(categoryTranslations);

    // --- FIREBASE CRUD ƒ∞≈ûLEMLERƒ∞ ---

    function transformProducts(dataSnapshot) {
      const productsArray = [];
      dataSnapshot.forEach(childSnapshot => {
        const product = childSnapshot.val();
        product.key = childSnapshot.key;
        productsArray.push(product);
      });
      return productsArray;
    }

    function setupFirebaseListener() {
        productsRef.on('value', (snapshot) => {
            if (snapshot.exists()) {
                products = transformProducts(snapshot);
            } else {
                products = [];
            }
            updateLanguageContent(); 
            if (!editPanel.classList.contains('hidden')) {
                const currentFilter = filterCategorySelect.value || 'T√ºm√º'; 
                renderEditList(currentFilter);
            }
        }, (error) => {
            console.error("Firebase veri okuma hatasƒ±:", error);
            alert("Men√ºy√º y√ºklerken bir hata olu≈ütu. (Veritabanƒ± baƒülantƒ±sƒ± veya kuralƒ±nƒ± kontrol edin)");
        });
    }

    async function updateProductInFirebase(key, updates) {
        await productsRef.child(key).update(updates);
    }

    async function deleteProductFromFirebase(key) {
        await productsRef.child(key).remove();
    }

    // --- CLOUDINARY Y√úKLEME WIDGET FONKSƒ∞YONU ---
    
    function openCloudinaryWidget(urlInput, previewImg) {
        if (!CLOUDINARY_CLOUD_NAME || !CLOUDINARY_UPLOAD_PRESET) {
            alert("Hata: L√ºtfen Cloudinary ayarlarƒ±nƒ±zƒ± (Cloud Name/Preset) kodda kontrol edin.");
            return;
        }

        const widget = window.cloudinary.createUploadWidget(
            {
                cloudName: CLOUDINARY_CLOUD_NAME,
                uploadPreset: CLOUDINARY_UPLOAD_PRESET,
                sources: ['local', 'url', 'camera'], 
            },
            (error, result) => {
                if (!error && result && result.event === "success") {
                    const url = result.info.secure_url;
                    urlInput.value = url; // Gizli inputa URL'yi yazar
                    previewImg.src = url; // √ñnizlemeyi g√ºnceller
                    previewImg.classList.remove('hidden'); // Yeni √ºr√ºnde gizli ise g√∂ster
                    alert("G√∂rsel Cloudinary'ye y√ºklendi ve URL otomatik olarak kaydedildi.");
                } else if (error) {
                    console.error("Cloudinary y√ºkleme hatasƒ±:", error);
                    alert("G√∂rsel y√ºklenirken bir hata olu≈ütu: " + error.message);
                }
            }
        );
        widget.open();
    }


    // --- UYGULAMA MANTIƒûI VE UI G√úNCELLEMELERƒ∞ ---

    function createCategoryTabs(){
        tabButtonsContainer.innerHTML = '';
        const categoriesToIterate = categoriesTR;

        categoriesToIterate.forEach((catTR, index) => {
            let btn = document.createElement('button');
            const catName = language === 'TR' ? catTR : categoriesEN[index];

            btn.className='tabBtn px-3 py-1 rounded whitespace-nowrap transition-colors duration-150 hover:bg-orange-200';
            btn.dataset.category=catTR;
            btn.textContent=catName;

            if(catTR==='T√ºm√º') {
                btn.classList.add('active-tab');
            }

            btn.addEventListener('click',()=>{
                document.querySelectorAll('.tabBtn').forEach(b=>b.classList.remove('active-tab'));
                btn.classList.add('active-tab');
                const categoryKey = btn.dataset.category;

                if(categoryKey==='ƒ∞leti≈üim'){
                    menuContainer.innerHTML='';
                    contactSection.classList.remove('hidden');
                } else {
                    contactSection.classList.add('hidden');
                    renderMenu(categoryKey);
                }
            });
            tabButtonsContainer.appendChild(btn);
        });
    }

    function renderMenu(category='T√ºm√º'){
      menuContainer.innerHTML='';
      const filtered = category==='T√ºm√º'?products:products.filter(p=>p.category===category);

      filtered.forEach(p=>{
        const card=document.createElement('div');
        card.className='bg-white rounded-xl shadow p-4 flex flex-col hover:shadow-lg transition-shadow duration-200';
        
        const name = language==='TR'?p.name:p.nameEN||p.name;
        const desc = language==='TR'?p.desc:p.descEN||p.desc||'';

        card.innerHTML=`
          <img src='${p.image}' alt='${name}' class='w-full h-40 object-cover rounded-lg mb-3 cursor-pointer'>
          <h3 class='font-bold text-xl mb-1'>${name}</h3>
          <p class='text-gray-600 text-sm mb-3 flex-grow'>${desc}</p>
          <p class='bg-orange-100 text-orange-700 inline-block px-3 py-1 rounded-full font-bold text-lg self-start'>${p.price} ‚Ç∫</p>
        `;
        card.querySelector('img').addEventListener('click',()=>{modalImage.src=p.image;imageModal.classList.remove('hidden');});
        menuContainer.appendChild(card);
      });
    }
    
    function updateLanguageContent() {
        if (language === 'TR') {
            adminLoginButton.innerHTML = '‚öôÔ∏è Y√∂netici Giri≈üi';
            contactTitle.textContent = 'ƒ∞leti≈üim';
            contactAddress.innerHTML = 'üìç Yamanevler Mah. Alemdaƒü Caddesi No 159 D<br>Olimpiyat Kokore√ß √úmraniye - ƒ∞stanbul';
            langTR.style.fontWeight = 'bold';
            langEN.style.fontWeight = 'normal';
        } else { 
            adminLoginButton.innerHTML = '‚öôÔ∏è Admin Login';
            contactTitle.textContent = 'Contact';
            contactAddress.innerHTML = 'üìç Yamanevler Mah. Alemdaƒü Caddesi No 159 D<br>Olimpiyat Kokore√ß √úmraniye - Istanbul (Turkey)';
            langTR.style.fontWeight = 'normal';
            langEN.style.fontWeight = 'bold';
        }

        createCategoryTabs();
        const activeTab = document.querySelector('.tabBtn.active-tab');
        const activeCategoryKey = activeTab ? activeTab.dataset.category : 'T√ºm√º';
        
        if (activeCategoryKey === 'ƒ∞leti≈üim') {
            menuContainer.innerHTML = '';
            contactSection.classList.remove('hidden');
        } else {
            contactSection.classList.add('hidden');
            renderMenu(activeCategoryKey);
        }
    }

    function populateCategorySelects() {
        const options = categoriesTR.filter(c => c !== 'T√ºm√º' && c !== 'ƒ∞leti≈üim');
        
        [productCategorySelect, filterCategorySelect, editCategorySelect].forEach(select => {
            select.innerHTML = ''; 
            options.forEach(cat => {
                const option = document.createElement('option');
                option.textContent = cat;
                select.appendChild(option);
            });
            if (select === filterCategorySelect) {
                const allOption = document.createElement('option');
                allOption.textContent = 'T√ºm√º';
                select.insertBefore(allOption, select.firstChild);
                select.value = 'T√ºm√º';
            }
        });
    }

    function renderEditList(filter='T√ºm√º') {
      productList.innerHTML = '';
      const filtered = filter==='T√ºm√º'?products:products.filter(p=>p.category===filter);

      filtered.forEach((p) => {
        const item = document.createElement('li');
        item.className = 'flex justify-between items-center bg-white p-3 rounded border shadow-sm';
        item.innerHTML = `
          <span class="font-medium text-sm">${p.name} (${p.category}) - ${p.price} ‚Ç∫</span>
          <div>
            <button data-key="${p.key}" class="editBtn bg-blue-500 text-white px-2 py-1 rounded text-xs hover:bg-blue-600 transition mr-2">D√ºzenle</button>
            <button data-key="${p.key}" class="deleteBtn bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600 transition">Sil</button>
          </div>
        `;
        productList.appendChild(item);
      });

      document.querySelectorAll('.deleteBtn').forEach(btn => {
        btn.addEventListener('click', async (e) => {
          const productKeyToDelete = e.target.dataset.key;
          if (confirm("Bu √ºr√ºn√º silmek istediƒüinizden emin misiniz?")) {
              try { await deleteProductFromFirebase(productKeyToDelete); alert("√úr√ºn silindi."); } 
              catch (error) { alert("Silme i≈ülemi ba≈üarƒ±sƒ±z oldu: " + error.message); }
          }
        });
      });

      document.querySelectorAll('.editBtn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const productKeyToEdit = e.target.dataset.key;
          const productToEdit = products.find(p => p.key === productKeyToEdit);
          
          if (productToEdit) {
            editProductKeyInput.value = productKeyToEdit; 
            editNameInput.value = productToEdit.name;
            editNameENInput.value = productToEdit.nameEN;
            editDescInput.value = productToEdit.desc;
            editDescENInput.value = productToEdit.descEN;
            editPriceInput.value = productToEdit.price;
            editCategorySelect.value = productToEdit.category;
            
            // Mevcut g√∂rsel URL'sini ve √∂nizlemeyi doldur
            editImageURLInput.value = productToEdit.image;
            editImagePreview.src = productToEdit.image;
            
            editProductModal.classList.remove('hidden');
          }
        });
      });
    }

    // --- EVENT LISTENERS ---

    // Cloudinary Butonlarƒ±
    uploadNewImageBtn.addEventListener('click', (e) => {
        e.preventDefault();
        openCloudinaryWidget(productImageURLInput, newImagePreview);
    });

    uploadEditImageBtn.addEventListener('click', (e) => {
        e.preventDefault();
        openCloudinaryWidget(editImageURLInput, editImagePreview);
    });

    // Diƒüer UI Butonlarƒ±
    langTR.addEventListener('click',()=>{ language='TR'; updateLanguageContent(); });
    langEN.addEventListener('click',()=>{ language='EN'; updateLanguageContent(); });
    imageModal.addEventListener('click',()=>imageModal.classList.add('hidden'));
    adminLoginBtn.addEventListener('click',()=>adminPanel.classList.remove('hidden'));
    closeAdmin.addEventListener('click',()=>adminPanel.classList.add('hidden'));
    closeEdit.addEventListener('click',()=>editPanel.classList.add('hidden'));
    closeEditProductModal.addEventListener('click',()=>editProductModal.classList.add('hidden'));

    checkPassword.addEventListener('click',()=>{
      if(passwordInput.value==='admin123'){ 
        adminPanel.classList.add('hidden');
        editPanel.classList.remove('hidden');
        loginError.classList.add('hidden');
        passwordInput.value='';
        populateCategorySelects();
        renderEditList(); 
      } else {
        loginError.classList.remove('hidden');
      }
    });

    filterCategorySelect.addEventListener('change', (e) => {
      renderEditList(e.target.value);
    });

    // YENƒ∞ √úR√úN EKLEME
    addProductButton.addEventListener('click', async () => {
      const name = productNameInput.value.trim();
      const desc = productDescInput.value.trim();
      const descEN = productDescENInput.value.trim();
      const price = parseFloat(productPriceInput.value);
      const category = productCategorySelect.value;
      const imageURL = productImageURLInput.value.trim() || 'https://images.unsplash.com/photo-1543825700-6c9233634125'; 

      if (!name || isNaN(price) || !category) { alert('L√ºtfen gerekli alanlarƒ± doldurunuz.'); return; }

      const newProduct = {
        name, nameEN: name, desc, descEN: descEN || desc,
        price, image: imageURL, category
      };

      try {
          await database.ref('products').push(newProduct); 
          alert(`"${name}" √ºr√ºn√º ba≈üarƒ±yla eklendi.`);
          // Formu temizle ve varsayƒ±lan g√∂rsele d√∂nd√ºr
          productNameInput.value = ''; productDescInput.value = ''; productDescENInput.value = ''; 
          productPriceInput.value = ''; 
          productImageURLInput.value = 'https://images.unsplash.com/photo-1543825700-6c9233634125'; 
          newImagePreview.src = 'https://images.unsplash.com/photo-1543825700-6c9233634125';
          newImagePreview.classList.add('hidden');
      } catch (error) {
          alert("Ekleme i≈ülemi ba≈üarƒ±sƒ±z oldu: " + error.message);
      }
    });
    
    // √úR√úN D√úZENLEME KAYDETME ƒ∞≈ûLEVƒ∞
    saveEditProductButton.addEventListener('click', async () => {
        const productKey = editProductKeyInput.value;
        const newImageURL = editImageURLInput.value.trim(); 

        const updates = {
            name: editNameInput.value.trim(),
            nameEN: editNameENInput.value.trim(),
            desc: editDescInput.value.trim(),
            descEN: editDescENInput.value.trim(),
            price: parseFloat(editPriceInput.value),
            category: editCategorySelect.value,
            image: newImageURL
        };
        
        if (isNaN(updates.price)) { alert('L√ºtfen ge√ßerli bir fiyat giriniz.'); return; }

        try {
            await updateProductInFirebase(productKey, updates); 
            editProductModal.classList.add('hidden');
            alert(`"${updates.name}" √ºr√ºn√º ba≈üarƒ±yla g√ºncellendi.`);
        } catch (error) {
            alert("G√ºncelleme i≈ülemi ba≈üarƒ±sƒ±z oldu: " + error.message);
        }
    });

    // --- ƒ∞lk Y√ºkleme ---
    document.addEventListener('DOMContentLoaded', () => {
      setupFirebaseListener(); 
    });
  </script>
</body>
</html>
